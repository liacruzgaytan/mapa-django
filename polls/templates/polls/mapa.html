{% extends 'polls/base.html' %}
{% load static %}

{% block title %}Mapa de México{% endblock %}

{% block content %}
  <h2>Mapa de México</h2>

  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />

  <div id="map" style="height: 600px; width: 100%; margin-bottom: 20px;"></div>

  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

  <script>
    const map = L.map('map').setView([23.6345, -102.5528], 5);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; OpenStreetMap contributors'
    }).addTo(map);

    fetch("{% static 'polls/mexico_estados.geojson' %}")
      .then(response => response.json())
      .then(data => {
        L.geoJSON(data, {
          style: feature => ({
            color: "#FF7800",
            weight: 2,
            opacity: 0.8,
            fillOpacity: 0.4,
            fillColor: "#FFA500"
          }),
          onEachFeature: (feature, layer) => {
            if (feature.properties && feature.properties.name) {
              layer.bindPopup(`<strong>${feature.properties.name}</strong>`);
            }
          }
        }).addTo(map);
      })
      .catch(error => {
        console.error("Error al cargar el archivo GeoJSON:", error);
        alert("No se pudo cargar el archivo GeoJSON.");
      });
  </script>
{% endblock %}
